/*! uvCharts - v0.1.0 - 2013-05-15
* http://github.com/hashd 
* Copyright (c) 2013 ; Licensed MIT */
var uv={};uv.Graph=function(){var e=this;return e.id=uv.util.getUniqueId(),e.graphdef=null,e.config=null,e.frame=null,e.panel=null,e.bg=null,e.effects={},e.axes={hor:{group:null,scale:null,func:null,axis:null,line:null,label:null},ver:{group:null,scale:null,func:null,axis:null,line:null,label:null}},e.labels=null,e.categories=null,this},uv.Graph.prototype.init=function(e,t){var n=this;return n.graphdef=e,n.config=$.extend(!0,{},uv.config,t),n.max(n.graphdef.stepup).position(n.config.meta.position||"body").setDimensions().setFrame().setPanel().setBackground().setCaption().setSubCaption().setMetadata().setHorizontalAxis().setVerticalAxis().setEffectsObject(),n},uv.Graph.prototype.setDimensions=function(){var e=this;return e.height(e.config.dimension.height).width(e.config.dimension.width).top(e.config.margin.top).bottom(e.config.margin.bottom).left(e.config.margin.left).right(e.config.margin.right),this},uv.Graph.prototype.setFrame=function(){var e=this;return e.frame||(e.frame=d3.select(e.position()||"body").append("svg")),e.frame.attr("id",uv.constants.classes.uv+"-"+e.id).classed(uv.constants.classes.frame,!0).attr("width",e.width()+e.left()+e.right()).attr("height",e.height()+e.top()+e.bottom()),e.frame.append("rect").classed(uv.constants.classes.framebg,!0).attr("width",e.width()+e.left()+e.right()).attr("height",e.height()+e.top()+e.bottom()).style("fill",e.config.frame.bgcolor),this},uv.Graph.prototype.setPanel=function(){var e=this;return e.panel||(e.panel=e.frame.append("g")),e.panel.attr("id",uv.constants.classes.panel+"-"+e.id).classed(uv.constants.classes.panel,!0).attr("transform","translate("+e.left()+","+e.top()+")"),this},uv.Graph.prototype.setBackground=function(e){var t=this;return t.bg||(t.bg=t.panel.append("rect").attr("class",uv.constants.classes.bg).attr("height",t.height()).attr("width",t.width())),t.bg.style("fill",e||t.config.graph.background),this},uv.Graph.prototype.setCaption=function(){var e=this;return e.caption=e.panel.append("g").attr("class",uv.constants.classes.caption),e.caption.append("text").attr("class",uv.constants.classes.captiontext).text(e.config.meta.caption).attr("y",-e.config.margin.top/2).attr("x",e.config.dimension.width/2).attr("text-anchor",e.config.caption.textanchor).style("font-family",e.config.caption.fontfamily).style("font-size",e.config.caption.fontsize).style("font-weight",e.config.caption.fontweight).style("font-variant",e.config.caption.fontvariant).style("text-decoration",e.config.caption.textdecoration).on("mouseover",uv.effects.caption.mouseover(e.config)).on("mouseout",uv.effects.caption.mouseout(e.config)),this},uv.Graph.prototype.setSubCaption=function(){var e=this;return e.subCaption=e.panel.append("g").attr("class",uv.constants.classes.subcaption),e.subCaption.append("text").attr("class",uv.constants.classes.subcaptiontext).text(e.config.meta.subcaption).attr("y",-e.config.margin.top/2+1*e.config.caption.fontsize).attr("x",e.config.dimension.width/2).attr("text-anchor",e.config.caption.textanchor).style("font-family",e.config.subCaption.fontfamily).style("font-size",e.config.subCaption.fontsize).style("font-weight",e.config.subCaption.fontweight).style("font-variant",e.config.subCaption.fontvariant).style("text-decoration",e.config.subCaption.textdecoration),this},uv.Graph.prototype.setMetadata=function(){var e=this;return e.labels=uv.util.getLabelArray(e.graphdef),e.categories=uv.util.getCategoryArray(e.graphdef),this},uv.Graph.prototype.setHorizontalAxis=function(){var e=this,t=e.graphdef;return e.axes.hor.group||(e.axes.hor.group=e.panel.append("g").attr("class",uv.constants.classes.horaxis).attr("transform","translate(0,"+e.height()+")").style("sharp-rendering","crispEdges")),e.config.graph.orientation==="Horizontal"?(e.axes.hor.scale=d3.scale.linear().domain([0,e.max()]).range([0,e.width()]).nice(),e.axes.hor.func=d3.svg.axis().scale(e.axes.hor.scale).ticks(e.config.axis.ticks).tickSize(-e.width(),e.config.axis.minor,0).tickPadding(e.config.axis.padding).tickSubdivide(e.config.axis.subticks).orient("bottom")):(e.axes.hor.scale=d3.scale.ordinal().rangeRoundBands([0,e.width()],e.config.scale.ordinality),e.axes.hor.func=d3.svg.axis().scale(e.axes.hor.scale).tickPadding(e.config.axis.padding).orient("bottom")),this},uv.Graph.prototype.setVerticalAxis=function(){var e=this,t=e.graphdef;return e.axes.ver.group||(e.axes.ver.group=e.panel.append("g").attr("class",uv.constants.classes.veraxis).style("sharp-rendering","crispEdges")),e.config.graph.orientation==="Vertical"?(e.axes.ver.scale=d3.scale.linear().domain([e.max(),0]).range([0,e.height()]).nice(),e.axes.ver.func=d3.svg.axis().scale(e.axes.ver.scale).ticks(e.config.axis.ticks).tickSize(-e.width(),e.config.axis.minor,0).tickPadding(e.config.axis.padding).tickSubdivide(e.config.axis.subticks).orient("left")):(e.axes.ver.scale=d3.scale.ordinal().rangeRoundBands([0,e.width()],e.config.scale.ordinality),e.axes.ver.func=d3.svg.axis().scale(e.axes.ver.scale).tickPadding(e.config.axis.padding).orient("left")),this},uv.Graph.prototype.setEffectsObject=function(){var e=this;for(var t=0;t<e.categories.length;t++)e.effects[e.categories[t].replace(" ","_","gim")]={};return e},uv.Graph.prototype.drawHorizontalAxis=function(){var e=this;return e.axes.hor.axis=e.axes.hor.group.append("g").style("font-family",e.config.label.fontfamily).style("font-size",e.config.label.fontsize).style("font-weight",e.config.label.fontweight).call(e.axes.hor.func),e.axes.hor.axis.selectAll("line").style("stroke",e.config.axis.strokecolor),e.axes.hor.axis.selectAll("path").style("fill","none"),e.axes.hor.line=e.panel.append("line").attr("class",uv.constants.classes.horaxis).attr("y1",e.height()).attr("y2",e.height()).attr("x1","0").attr("x2",e.width()).style("stroke",e.config.axis.strokecolor),e.axes.hor.label=e.axes.hor.group.append("g").classed("r3_axeslabelgroup",!0).attr("transform","translate("+e.width()/2+","+(e.config.margin.bottom/2+1*e.config.label.fontsize)+")"),e.axes.hor.label.append("text").attr("display","block").attr("class","r3_axeslabel").classed("cal",!0).attr("text-anchor","middle").style("font-size",e.config.axis.fontsize).style("font-family",e.config.axis.fontfamily).text(e.config.meta.hlabel),e.axes.hor.label.append("text").attr("display","block").attr("y",1*e.config.axis.fontsize).attr("class","r3_axessublabel").classed("casl",!0).attr("text-anchor","middle").style("font-size",e.config.axis.fontsize-2).style("font-family",e.config.axis.fontfamily).text(e.config.meta.hsublabel),this},uv.Graph.prototype.drawVerticalAxis=function(){var e=this;return e.axes.ver.axis=e.axes.ver.group.append("g").classed(uv.constants.classes.axes,!0).style("font-family",e.config.label.fontfamily).style("font-size",e.config.label.fontsize).style("font-weight",e.config.label.fontweight).call(e.axes.ver.func),e.axes.ver.axis.selectAll("line").style("stroke",e.config.axis.strokecolor),e.axes.ver.axis.selectAll("path").style("fill","none"),e.axes.ver.line=e.panel.append("line").attr("class",uv.constants.classes.veraxis).attr("y1",0).attr("y2",e.height()).style("stroke",e.config.axis.strokecolor),e.axes.ver.label=e.axes.ver.group.append("g").attr("transform","translate("+ -4*e.config.margin.left/5+","+e.height()/2+")rotate(270)"),e.axes.ver.label.append("text").attr("class",uv.constants.classes.axeslabel).attr("text-anchor","middle").classed("cal",!0).style("font-family",e.config.axis.fontfamily).style("font-size",e.config.axis.fontsize).text(e.config.meta.vlabel),e.axes.ver.label.append("text").attr("class",uv.constants.classes.axessublabel).attr("text-anchor","middle").attr("y",+e.config.axis.fontsize).classed("casl",!0).style("font-family",e.config.axis.fontfamily).style("font-size",e.config.axis.fontsize-2).text(e.config.meta.vsublabel),this},uv.Graph.prototype.setLegend=function(){var e=this,t=e.panel.append("g").attr("class",uv.constants.classes.legend).attr("transform","translate("+e.width()+","+10+")");return e.legends=t.selectAll("g").data(e.categories).enter().append("g").attr("transform",function(e,t){return"translate(10,"+10*(2*t-1)+")"}).attr("class",function(t,n){return"cl_"+e.categories[n]}).attr("disabled","false").on("mouseover",function(t,n){e.effects[t].mouseover()}).on("mouseout",function(t,n){e.effects[t].mouseout()}).on("click",function(t,n){uv.effects.legend.click(n,this,e)}),e.legends.append("rect").attr("class",uv.constants.classes.legendsign).attr("height",e.config.legend.symbolsize).attr("width",e.config.legend.symbolsize).style("fill",function(t,n){return uv.util.getColorBand(e.config,n)}).style("stroke","none"),e.legends.append("text").attr("class",uv.constants.classes.legendlabel).text(function(t,n){return e.categories[n]}).attr("dx",e.config.legend.textmargin).attr("dy",".71em").attr("text-anchor","start").style("font-family",e.config.legend.fontfamily).style("font-size",e.config.legend.fontsize).style("font-weight",e.config.legend.fontweight),this},uv.Graph.prototype.finalize=function(e){var t=this;return t.drawHorizontalAxis().drawVerticalAxis().setLegend(),e&&console.log(t),this},uv.Graph.prototype.remove=function(){return this.frame.remove(),this},uv.Graph.prototype.removeCaption=function(){return this.caption.remove(),this},uv.Graph.prototype.removeLegend=function(){return this.legends[0]&&this.legends[0].parentNode.remove(),this},uv.Graph.prototype.removePanel=function(){return this.panel.remove(),this},uv.Graph.prototype.removeHorAxis=function(){return this.panel.selectAll("g."+uv.constants.classes.horaxis+" > *").remove(),this.panel.selectAll("line."+uv.constants.classes.horaxis).remove(),this},uv.Graph.prototype.removeVerAxis=function(){return this.panel.selectAll("g."+uv.constants.classes.veraxis+" > *").remove(),this.panel.selectAll("line."+uv.constants.classes.veraxis).remove(),this},uv.Graph.prototype.width=function(e){return e?(this.config.dimension.width=e,this):this.config.dimension.width},uv.Graph.prototype.height=function(e){return e?(this.config.dimension.height=e,this):this.config.dimension.height},uv.Graph.prototype.top=function(e){return e?(this.config.margin.top=e,this):this.config.margin.top},uv.Graph.prototype.bottom=function(e){return e?(this.config.margin.bottom=e,this):this.config.margin.bottom},uv.Graph.prototype.left=function(e){return e?(this.config.margin.left=e,this):this.config.margin.left},uv.Graph.prototype.right=function(e){return e?(this.config.margin.right=e,this):this.config.margin.right},uv.Graph.prototype.position=function(e){return e?(this.config.meta.position=e,this):this.config.meta.position},uv.Graph.prototype.caption=function(e){return e?(this.config.meta.caption=e,this):this.config.meta.caption},uv.Graph.prototype.subCaption=function(e){return e?(this.config.meta.subCaption=e,this):this.config.meta.caption},uv.Graph.prototype.max=function(e){return e===!0?(this.config.graph.max=uv.util.getStepMaxValue(this.graphdef),this):e===!1?(this.config.graph.max=uv.util.getMaxValue(this.graphdef),this):e==="percent"?(this.config.graph.max=100,this):this.config.graph.max},uv.Graph.prototype.toggleGraphGroup=function(e){var t=this,n=t.categories[e],r=t.frame.select("g.cge_"+n.replace(" ","_","gim")).style("display"),i=uv.util.getColorBand(t.config,e);return t.frame.selectAll("g.cge_"+n.replace(" ","_","gim")).style("display",r==="none"?null:"none"),this},uv.util={},uv.util.extend=function(e){function t(){}return t.prototype=e.prototype||e,new t},uv.util.getUniqueId=function(){return(new Date).getTime()},uv.util.getMaxValue=function(e){return d3.max(e.categories.map(function(t){return d3.max(e.dataset[t].map(function(e){return e.value}))}))},uv.util.getStepMaxValue=function(e){var t=e.dataset[e.categories[0]].map(function(){return 0});return e.categories.map(function(n){e.dataset[n].map(function(e,n){t[n]+=e.value})}),d3.max(t)},uv.util.getSumUpArray=function(e){var t=e.dataset[e.categories[0]].map(function(){return 0});return e.categories.map(function(n){e.dataset[n].map(function(e,n){t[n]+=e.value})}),t},uv.util.getPercentage=function(e,t){return e*100/t},uv.util.getDataArray=function(e){return e.categories.map(function(t){return e.dataset[t]})},uv.util.getTabularArray=function(e){var t=[],n,r,i,s,o=[];for(n=0,s=e.dataset[e.categories[0]].length;n<s;n+=1){o=[],o.push(e.dataset[e.categories[0]][n].name);for(r=0,i=e.categories.length;r<i;r+=1)o.push(e.dataset[e.categories[r]][n].value);t.push(o)}return t},uv.util.getLabelArray=function(e){return e.dataset[e.categories[0]].map(function(e){return e.name})},uv.util.getCategoryArray=function(e){return e.categories.map(function(e){return e})},uv.util.getCategoryData=function(e,t){return t.map(function(t){return e.dataset[t].map(function(e){return e.value})})},uv.util.transposeData=function(e){var t={},n,r,i,s,o,u,a,f=e.dataset[e.categories[0]].map(function(e){return e.name});for(n=0,i=f.length;n<i;n+=1)t[f[n]]=[];for(n=0,i=e.categories.length;n<i;n+=1){o=e.categories[n];for(r=0,s=e.dataset[o].length;r<s;r+=1)u=e.dataset[o][r].name,a=e.dataset[o][r].value,t[u].push({name:o,value:a})}e.categories=f,e.dataset=t},uv.util.getPascalCasedName=function(e){return e.substring(0,1).toUpperCase()+e.substring(1)},uv.util.getColorBand=function(e,t){var n=uv.palette[e.graph.palette].length;return uv.palette[e.graph.palette][t%n]},uv.config={graph:{palette:"Brink",background:"white",orientation:"Horizontal",max:0},meta:{position:".r3_div",caption:"Usage of browsers by the years",subcaption:"Among major vendors",hlabel:"Horizontal Axis Label",vlabel:"Vertical Axis Label",hsublabel:"h sublabel",vsublabel:"v sublabel"},dimension:{width:400,height:400},margin:{top:50,bottom:90,left:100,right:100},frame:{bgcolor:"white"},axis:{ticks:8,subticks:2,padding:5,minor:-10,strokecolor:"#000",fontfamily:"Arial",fontsize:"14",fontweight:"bold"},label:{fontfamily:"Arial",fontsize:"11",fontweight:"normal",strokecolor:"#000"},scale:{ordinality:.2},bar:{strokecolor:"none",fontfamily:"Arial",fontsize:"10",fontweight:"bold",textcolor:"#000"},line:{interpolation:"linear"},area:{interpolation:"cardinal",offset:"zero",opacity:.2},pie:{fontfamily:"Arial",fontsize:"14",fontweight:"normal",fontvariant:"small-caps",fontfill:"white",strokecolor:"none",strokewidth:2},donut:{fontfamily:"Arial",fontsize:"14",fontweight:"normal",fontvariant:"small-caps",fontfill:"white",factor:.4,strokecolor:"none",strokewidth:2},caption:{fontfamily:"Arial",fontsize:"14",fontweight:"bold",fontvariant:"small-caps",textdecoration:"none",hovercolor:"dimgrey",textanchor:"middle"},subCaption:{fontfamily:"Arial",fontsize:"9",fontweight:"normal",fontvariant:"normal",textdecoration:"none",textanchor:"middle"},legend:{fontfamily:"Arial",fontsize:"11",fontweight:"normal",textmargin:15,symbolsize:10,inactive_color:"#DDD"},effects:{hovercolor:"red",strokecolor:"none",textcolor:"black",duration:800,hover:400}},uv.constants={},uv.constants.graphdef={categories:["IE","Chrome","Opera","Safari"],dataset:{IE:[{name:"2001",value:60},{name:"2002",value:70},{name:"2003",value:80},{name:"2004",value:90},{name:"2005",value:20}],Chrome:[{name:"2001",value:10},{name:"2002",value:30},{name:"2003",value:50},{name:"2004",value:90},{name:"2005",value:70}],Firefox:[{name:"2001",value:50},{name:"2002",value:150},{name:"2003",value:20},{name:"2004",value:80},{name:"2005",value:40}],Opera:[{name:"2001",value:90},{name:"2002",value:60},{name:"2003",value:30},{name:"2004",value:10},{name:"2005",value:70}],Safari:[{name:"2001",value:30},{name:"2002",value:10},{name:"2003",value:60},{name:"2004",value:90},{name:"2005",value:40}]}},uv.constants.name={pos:"r3_div",frame:"r3_frame",panel:"r3_panel",background:"r3_bg",horaxis:"r3_horaxis",veraxis:"r3_veraxis",table:{tableclass:"r3_table",headerclass:"r3_header",bodyclass:"r3_body",footerclass:"r3_footer"}},uv.constants.classes={uv:"uv",pos:"uv-div",frame:"uv-frame",panel:"uv-panel",bg:"uv-bg",axes:"uv-axes",legend:"uv-legend",framebg:"uv-frame-bg",horaxis:"uv-hor-axis",veraxis:"uv-ver-axis",caption:"uv-caption",captiontext:"uv-caption-text",subcaption:"uv-subcaption",subcaptiontext:"uv-subcaption-text",axeslabel:"uv-axes-label",axessublabel:"uv-axes-sub-label",legendsign:"uv-legend-sign",legendlabel:"uv-legend-label"},uv.types={},uv.addChart=function(e,t){uv.types[e]=t},uv.addChart("Bar","BarGraph"),uv.addChart("Line","LineGraph"),uv.addChart("StackedBar","StackedBarGraph"),uv.addChart("StepUpBar","StepUpBarGraph"),uv.addChart("Area","AreaGraph"),uv.addChart("StackedArea","StackedAreaGraph"),uv.addChart("PercentBar","PercentBarGraph"),uv.addChart("PercentArea","PercentAreaGraph"),uv.addChart("Pie","PieGraph"),uv.addChart("Donut","DonutGraph"),uv.chart=function(e,t,n){if(uv.types[e]!==undefined)return new uv[uv.types[e]](t,n)},uv.effects={},uv.effects.bar={},uv.effects.bar.mouseover=function(e,t){var n=e.config,r=e.categories[t].replace(" ","_","gim"),i=function(){e.frame.selectAll("rect.cr_"+r).transition().duration(n.effects.hover).style("fill",n.effects.hovercolor).style("stroke",n.effects.strokecolor),e.frame.selectAll("text.cr_"+r).transition().duration(n.effects.hover).style("fill",n.effects.textcolor).style("opacity",1)};return e.effects[r].mouseover=i,i},uv.effects.bar.mouseout=function(e,t,n){var r=e.config,i=e.categories[t].replace(" ","_","gim");n=n||uv.util.getColorBand(e.config,t);var s=function(){e.frame.selectAll("rect.cr_"+i).transition().duration(r.effects.hover).style("fill",n).style("stroke","none"),e.frame.selectAll("text.cr_"+i).transition().duration(r.effects.hover).style("fill","none")};return e.effects[i].mouseout=s,s},uv.effects.area={},uv.effects.area.mouseover=function(e,t){var n=e.config,r=e.categories[t].replace(" ","_","gim"),i=function(){e.frame.selectAll(".cge_"+r).select("path.area_"+r).transition().duration(n.effects.hover).style("fill",n.effects.hovercolor)};return e.effects[r].mouseover=i,i},uv.effects.area.mouseout=function(e,t){var n=e.config,r=e.categories[t].replace(" ","_","gim"),i=function(){e.frame.selectAll(".cge_"+r).select("path.area_"+r).transition().duration(n.effects.hover).style("fill",uv.util.getColorBand(n,t))};return e.effects[r].mouseout=i,i},uv.effects.line={},uv.effects.line.mouseover=function(e,t){var n=e.config,r=e.categories[t].replace(" ","_","gim"),i=function(){e.frame.selectAll(".cge_"+r).selectAll("circle").transition().duration(n.effects.hover).style("fill",n.effects.hovercolor).style("fill-opacity",1).style("stroke",n.effects.hovercolor),e.frame.selectAll(".cge_"+r).select("path").transition().duration(n.effects.hover).style("stroke",n.effects.hovercolor),e.frame.selectAll(".cge_"+r).selectAll("text").transition().duration(n.effects.hover).style("fill",n.effects.textcolor)};return e.effects[r].mouseover=i,i},uv.effects.line.mouseout=function(e,t,n){var r=e.config,i=e.categories[t].replace(" ","_","gim"),n=n||uv.util.getColorBand(e.config,t),s=function(){e.frame.selectAll(".cge_"+i).selectAll("circle").transition().duration(r.effects.hover).style("fill",n).style("fill-opacity",.6).style("stroke",n),e.frame.selectAll(".cge_"+i).select("path").transition().duration(r.effects.hover).style("stroke",n),e.frame.selectAll(".cge_"+i).selectAll("text").transition().duration(r.effects.hover).style("fill","none")};return e.effects[i].mouseout=s,s},uv.effects.caption={},uv.effects.caption.mouseover=function(e){return function(){d3.select(this.parentNode.parentNode).select("."+uv.constants.name.background).transition().duration(e.effects.duration).style("fill",e.caption.hovercolor)}},uv.effects.caption.mouseout=function(e){return function(){d3.select(this.parentNode.parentNode).select("."+uv.constants.name.background).transition().duration(e.effects.duration).style("fill",e.graph.background)}},uv.effects.donut={},uv.effects.donut.mouseover=function(e,t,n,r){return function(r){var i={x:t.centroid(r)[0]/5,y:t.centroid(r)[1]/5};d3.select(this.parentNode).transition().duration(n.effects.duration).attr("transform","translate("+(e.x+i.x)+","+(e.y+i.y)+")")}},uv.effects.donut.mouseout=function(e,t){return function(){d3.select(this.parentNode).transition().duration(t.effects.duration).attr("transform","translate("+e.x+","+e.y+")")}},uv.effects.pie={},uv.effects.pie.mouseover=function(e,t,n,r){return function(r){var i={x:t.centroid(r)[0]/5,y:t.centroid(r)[1]/5};d3.select(this.parentNode).transition().duration(n.effects.duration).attr("transform","translate("+(e.x+i.x)+","+(e.y+i.y)+")")}},uv.effects.pie.mouseout=function(e,t){return function(){d3.select(this.parentNode).transition().duration(t.effects.duration).attr("transform","translate("+e.x+","+e.y+")")}},uv.effects.legend={},uv.effects.legend.mouseover=function(e,t){return e.effects.group[e.categories[t]].mouseover},uv.effects.legend.mouseout=function(e,t){return e.effects.group[e.categories[t]].mouseout},uv.effects.legend.click=function(e,t,n){var r=d3.select(t).attr("disabled")==="false"?!1:!0;n.toggleGraphGroup(e),d3.select(t).select("rect").style("fill",r?uv.util.getColorBand(n.config,e):uv.config.legend.inactive_color),d3.select(t).select("text").style("fill",r?null:uv.config.legend.inactive_color),d3.select(t).attr("disabled",r?"false":"true")},uv.palette={Plain:["#1F77B4"],Simple:["#d42f3c","#85b1e6","#FD6D16","#dfe617"],RGB:["#bb2211","#2222bb","#22aa22","#9999aa","#223322"],Olive:["#B4AF91","#787746","#40411E","#32331D"],"Soil and Sky":["#928174","#AA9788","#BDE4E9","#A8E1E9","#90D1DA"],Candid:["#EADEA1","#808355","#4E493D","#3A301C","#3F7696"],Sulphide:["#949993","#615952","#343640","#A15026","#C7B091"],"New Moon":["#EEE6AB","#C5BC8E","#696758","#45484B","#36393B"],Nature:["#EEEFD8","#BECD8A","#73880A","#CCCC33","#E2EAA3"],Earth:["#862424","#D8D1B4","#B3AB8E","#F1F0E9","#353535"],Sea:["#334433","#6699aa","#88aaaa","#aacccc","#447799"],Lemon:["#eebb00","#ddaa00","#eecc00","#ffee11"],Water:["#2266bb","#3388dd","#55aaee","#bbddee","#113355"],Grass:["#00AF64","#36D729","#61D7A4","#007241"],Hash:["tomato","yellowgreen","midnightblue","lightseagreen","gold"],Soft:["#f1b2e1","#b1ddf3","#ffde89","#e3675c","#c2d985"],Brink:["#01243b","#5288d8","#9da7b2","#c5c5c5","#71c42b"],Bright:["#ef597b","#ff6d31","#73b66b","#ffcb18","#29a2c6"],Lint:["#667b99","#afbbd2","#ccd5e6","#e9eef6","#ff6637"]},uv.Test=function(){var e=this;e.categories=["fruits","browsers","distros","countries"],e.categoryData={fruits:["oranges","apples","mangoes","pears","berries","guava","pineapples","watermelons"],browsers:["firefox","safari","ie","chrome","opera","maxthon","midori","epiphany"],distros:["Linux Mint","Ubuntu","PCLinuxOS","Fedora","Rosa","OpenSUSE","Sabayon Linux"],countries:["U.S.A","U.K","India","China","Canada","Brazil","Pakistan","France","Spain","Australia"]},e.labels=["years","users","mood"],e.labelData={years:["2001","2002","2003","2004","2005","2006","2007","2008","2009","2010"],users:["infants","kids","teens","middleage","oldage"],mood:["happy","sad","excited","surprised","none","angry"]},e.init()},uv.Test.prototype.init=function(){var e=this,t=uv.Test.getRandomInteger(0,e.labels.length),n=uv.Test.getRandomInteger(0,e.categories.length),r=e.labels[t],i=e.categories[n],s=uv.Test.getRandomInteger(1,e.labelData[r].length+1),o=uv.Test.getRandomInteger(1,e.categoryData[i].length+1);e.categorySet=uv.Test.getRandomSet(e.categoryData[i],o),e.labelSet=uv.Test.getRandomSet(e.labelData[r],s)},uv.Test.getRandomSet=function(e,t){var n=this,r=[],i=[],s=0;while(s!=t){var o=uv.Test.getRandomInteger(0,e.length);r.indexOf(o)==-1&&(i.push(e[o]),r.push(o),s+=1)}return i},uv.Test.prototype.getGraphDef=function(){var e=this,t={};return t.categories=e.categorySet,t.dataset=e.getDataset(),console.log(t),t},uv.Test.prototype.getDataset=function(){var e=this,t={};for(var n=0,r=e.categorySet.length;n<r;n++){var i=[],s=e.categorySet[n];for(var o=0,u=e.labelSet.length;o<u;o++)i.push(uv.Test.getDataElement(e.labelSet[o]));t[s]=i}return t},uv.Test.getDataElement=function(e){var t=this,n={};return n.name=e,n.value=uv.Test.getRandomInteger(1,1e3),n},uv.Test.getRandomValue=function(e,t){return Math.random()*(t-e+1)+e},uv.Test.getRandomDataset=function(e,t,n){var r=this,i=[];for(var s=0;s<e;s++)i.push(uv.Test.getRandomValue(t,n))},uv.Test.getRandomInteger=function(e,t){return Math.floor(Math.random()*(t-e))+e},uv.Test.getRandomIntegers=function(e,t,n){var r=this,i=[];for(var s=0;s<e;s++)i.push(uv.Test.getRandomInteger(t,n));return i},uv.AreaGraph=function(e,t){var n=this;uv.Graph.call(n).setDefaults(e,t).init(e,t),n.areagroups=[],n.dataset=uv.util.getDataArray(n.graphdef);var r,i,s,o,u,a=n.graphdef.dataset[n.graphdef.categories[0]];n.axes[n.config.graph.orientation==="Horizontal"?"ver":"hor"].scale.domain(a.map(function(e){return e.name}));for(o=0,u=n.dataset.length;o<u;o+=1)i=n.panel.append("g").attr("class","cg_"+n.categories[o]).append("g").attr("class","cge_"+n.categories[o]).datum(n.dataset[o]),r={path:i,linefunc:undefined,areafunc:undefined,line:undefined,area:undefined},n["draw"+n.config.graph.orientation+"Area"](r,o),n.areagroups.push(r);n.finalize()},uv.AreaGraph.prototype=uv.util.extend(uv.Graph),uv.AreaGraph.prototype.setDefaults=function(e,t){return e.stepup=!1,this},uv.AreaGraph.prototype.drawHorizontalArea=function(e,t){var n=this,r=uv.util.getColorBand(n.config,t);n.axes.ver.scale.rangePoints([0,n.height()]),e.linefunc=d3.svg.line().x(function(e){return n.axes.hor.scale(e.value)}).y(function(e){return n.axes.ver.scale(e.name)+n.axes.ver.scale.rangeBand()/2}).interpolate(n.config.area.interpolation),e.areafunc=d3.svg.area().x0(n.axes.hor.scale(0)).x1(e.linefunc.x()).y(e.linefunc.y()).interpolate(n.config.area.interpolation),e.area=e.path.append("svg:path").attr("class","areapath_"+t).attr("d",e.areafunc).style("opacity",n.config.area.opacity).style("-moz-opacity",n.config.area.opacity).style("fill",r),e.line=e.path.append("svg:path").attr("class","linepath_"+t).attr("d",e.linefunc).style("stroke","white").style("fill","none"),e.path.selectAll(".dot").data(n.dataset[t]).enter().append("circle").attr("class","dot").attr("cx",e.linefunc.x()).attr("cy",e.linefunc.y()).attr("r",3.5).style("fill","white")},uv.AreaGraph.prototype.drawVerticalArea=function(e,t){var n=this,r=uv.util.getColorBand(n.config,t);n.axes.hor.scale.rangePoints([0,n.width()]),e.linefunc=d3.svg.line().x(function(e){return n.axes.hor.scale(e.name)+n.axes.hor.scale.rangeBand()/2}).y(function(e){return n.axes.ver.scale(e.value)}).interpolate(n.config.area.interpolation),e.areafunc=d3.svg.area().x(e.linefunc.x()).y0(e.linefunc.y()).y1(n.axes.ver.scale(0)).interpolate(n.config.area.interpolation),e.area=e.path.append("svg:path").attr("class","areapath_"+t).attr("d",e.areafunc).style("opacity",n.config.area.opacity).style("-moz-opacity",n.config.area.opacity).style("fill",r),e.line=e.path.append("svg:path").attr("class","linepath_"+t).attr("d",e.linefunc).style("stroke","white").style("fill","none"),e.path.selectAll(".dot").data(n.dataset[t]).enter().append("circle").attr("class","dot").attr("cx",e.linefunc.x()).attr("cy",e.linefunc.y()).attr("r",3.5).style("fill","white")},uv.BarGraph=function(e,t){var n=this;uv.Graph.call(n).setDefaults(e,t).init(e,t),n.bargroups={},n.axes[n.config.graph.orientation==="Horizontal"?"ver":"hor"].scale.domain(n.labels);var r,i=n.categories.length,s;for(r=0;r<i;r+=1)s=n.categories[r],n.bargroups[s]=n.panel.append("g").attr("class","r3_bargroup").classed("cg_"+s,!0),n["draw"+n.config.graph.orientation+"Bars"](r);n.finalize()},uv.BarGraph.prototype=uv.util.extend(uv.Graph),uv.BarGraph.prototype.setDefaults=function(e,t){return e.stepup=!1,this},uv.BarGraph.prototype.drawHorizontalBars=function(e){var t=this,n=uv.util.getColorBand(this.config,e),r=t.categories.length;bars=t.bargroups[t.categories[e]].selectAll("g").data(t.graphdef.dataset[t.categories[e]]).enter().append("g").attr("class","cge_"+t.categories[e].replace(" ","_","gim")),bars.append("rect").attr("class",t.id+"_"+t.categories[e]).classed("cr_"+t.categories[e],!0).attr("height",t.axes.ver.scale.rangeBand()/r).attr("x",0).attr("y",function(e){return t.axes.ver.scale(e.name)}).style("stroke",t.config.bar.strokecolor).style("fill",n).on("mouseover",uv.effects.bar.mouseover(t,e)).on("mouseout",uv.effects.bar.mouseout(t,e)).transition().duration(t.config.effects.duration).delay(function(e,n){return n*t.config.effects.duration}).attr("width",function(e){return t.axes.hor.scale(e.value)}),bars.append("text").attr("y",function(e){return t.axes.ver.scale(e.name)+t.axes.ver.scale.rangeBand()/r/2}).attr("dx",4).attr("dy",".35em").attr("text-anchor","start").classed("cr_"+t.categories[e],!0).style("fill","none").style("font-family",t.config.bar.fontfamily).style("font-size",t.config.bar.fontsize).style("font-weight",t.config.bar.fontweight).text(function(e){return String(e.value)}).transition().duration(t.config.effects.duration).delay(function(e,n){return n*t.config.effects.duration}).attr("x",function(e){return t.axes.hor.scale(e.value)}),bars.append("svg:title").text(function(n,r){return t.categories[e]+" ["+t.labels[r]+"] : "+n.value}),t.bargroups[t.categories[e]].attr("transform","translate(0,"+e*t.axes.ver.scale.rangeBand()/r+")")},uv.BarGraph.prototype.drawVerticalBars=function(e){var t=this,n=uv.util.getColorBand(this.config,e),r=t.categories.length;bars=t.bargroups[t.categories[e]].selectAll("g").data(t.graphdef.dataset[t.categories[e]]).enter().append("g").attr("class","cge_"+t.categories[e].replace(" ","_","gim")),bars.append("rect").attr("class",t.id+"_"+t.categories[e]).classed("cr_"+t.categories[e],!0).attr("height",0).attr("width",0).attr("x",function(e){return t.axes.hor.scale(e.name)}).attr("y",0).style("stroke",t.config.bar.strokecolor).style("fill",n).on("mouseover",uv.effects.bar.mouseover(t,e)).on("mouseout",uv.effects.bar.mouseout(t,e)).transition().duration(t.config.effects.duration).delay(e*t.config.effects.duration).attr("height",function(e){return t.height()-t.axes.ver.scale(e.value)}).attr("width",t.axes.hor.scale.rangeBand()/r),bars.append("text").attr("transform","scale(1,-1)").attr("x",function(e){return t.axes.hor.scale(e.name)+t.axes.hor.scale.rangeBand()/r/2}).attr("y",-10).attr("dx",0).attr("dy",".35em").attr("text-anchor","middle").classed("cr_"+t.categories[e],!0).style("fill","none").style("font-family",t.config.bar.fontfamily).style("font-size",t.config.bar.fontsize).style("font-weight",t.config.bar.fontweight).text(function(e){return String(e.value)}).transition().duration(t.config.effects.duration).delay(e*t.config.effects.duration).attr("y",function(e){return-(t.height()-t.axes.ver.scale(e.value))-10}),bars.append("svg:title").text(function(n,r){return t.categories[e]+" ["+t.labels[r]+"] : "+n.value}),t.bargroups[t.categories[e]].attr("transform","translate("+e*t.axes.hor.scale.rangeBand()/r+","+t.height()+") scale(1,-1)")},uv.DonutGraph=function(e,t){var n=this;uv.Graph.call(n).setDefaults(e,t).init(e,t),n.radius=Math.min(n.height(),n.width())*2/5,n.center={x:n.width()/2,y:n.height()/2},n.category=e.categories[0];var r=uv.util.getCategoryData(n.graphdef,[n.category]),i=d3.svg.arc().innerRadius(n.radius*n.config.donut.factor).outerRadius(n.radius),s=d3.layout.pie();n.panel.data(r),n.arcs=n.panel.selectAll("g.arc").data(s).enter().append("g").attr("class","r_arc_"+n.category).attr("transform","translate("+n.center.x+","+n.center.y+")"),n.arcs.append("path").attr("d",i).style("fill",function(e,t){return uv.util.getColorBand(n.config,t)}).style("stroke",n.config.donut.strokecolor).style("stroke-width",n.config.donut.strokewidth).on("mouseover",uv.effects.donut.mouseover(n.center,i,n.config)).on("mouseout",uv.effects.donut.mouseout(n.center,n.config)),n.arcs.append("text").attr("transform",function(e){return"translate("+i.centroid(e)+")"}).attr("dy",".35em").attr("text-anchor","middle").style("fill",n.config.donut.fontfill).style("font-family",n.config.donut.fontfamily).style("font-size",n.config.donut.fontsize).style("font-weight",n.config.donut.fontweight).style("font-variant",n.config.donut.fontvariant).text(function(e){return String(e.value)}),n.arcs.append("svg:title").text(function(e,t){return n.labels[t]+" : "+e.value})},uv.DonutGraph.prototype=uv.util.extend(uv.Graph),uv.DonutGraph.prototype.setDefaults=function(e,t){return e.stepup=!1,this},uv.LineGraph=function(e,t){var n=this;uv.Graph.call(n).setDefaults(e,t).init(e,t),n.linegroups={},n.dataset=uv.util.getDataArray(n.graphdef);var r,i,s,o,u=n.categories.length,a=n.labels;n.axes[n.config.graph.orientation==="Horizontal"?"ver":"hor"].scale.domain(a);for(o=0;o<u;o+=1)i=n.panel.append("g").attr("class","cg_"+n.categories[o]).append("g").attr("class","cge_"+n.categories[o]).datum(n.dataset[o]),r={path:i,func:undefined},n["draw"+n.config.graph.orientation+"Lines"](r,o,color),n.linegroups[n.categories[o]]=r;n.finalize()},uv.LineGraph.prototype=uv.util.extend(uv.Graph),uv.LineGraph.prototype.setDefaults=function(e,t){return e.stepup=!1,t.scale.ordinality=0,this},uv.LineGraph.prototype.drawHorizontalLines=function(e,t){var n=this,r=n.axes,i=n.config,s=uv.util.getColorBand(n.config,t);return e.func=d3.svg.line().x(function(e){return r.hor.scale(e.value)}).y(function(e){return r.ver.scale(e.name)+r.ver.scale.rangeBand()/2}).interpolate(uv.config.line.interpolation),e.path.append("path").classed("cr_"+n.categories[t],!0).attr("d",e.func).style("fill","none").style("stroke",s).style("stroke-width",1.5).style("stroke-opacity",.01).on("mouseover",uv.effects.line.mouseover(n,t)).on("mouseout",uv.effects.line.mouseout(n,t,s)).transition().duration(3*n.config.effects.duration).delay(2*t*n.config.effects.duration).style("stroke-opacity",1),e.path.selectAll("circle").data(n.dataset[t]).enter().append("circle").classed("cr_"+n.categories[t],!0).attr("cx",e.func.x()).attr("cy",e.func.y()).attr("r",3.5).style("fill",s).style("fill-opacity",.6).style("stroke",s).on("mouseover",uv.effects.line.mouseover(n,t)).on("mouseout",uv.effects.line.mouseout(n,t,s)).append("svg:title").text(function(e,r){return n.categories[t]+" ["+n.labels[r]+"]: "+e.value}),e.path.selectAll("text").data(n.dataset[t]).enter().append("text").attr("x",function(e){return r.hor.scale(e.value)}).attr("y",function(e){return r.ver.scale(e.name)+r.ver.scale.rangeBand()/2}).attr("dx",10).attr("dy",".35em").attr("text-anchor","start").classed("cr_"+n.categories[t],!0).style("fill","none").style("font-family",n.config.bar.fontfamily).style("font-size",n.config.bar.fontsize).style("font-weight",n.config.bar.fontweight).text(function(e){return String(e.value)}),this},uv.LineGraph.prototype.drawVerticalLines=function(e,t){var n=this,r=n.axes,i=n.config,s=uv.util.getColorBand(n.config,t);return e.func=d3.svg.line().x(function(e){return r.hor.scale(e.name)+r.hor.scale.rangeBand()/2}).y(function(e){return r.ver.scale(e.value)}).interpolate(uv.config.line.interpolation),e.path.append("path").attr("d",e.func).classed("cr_"+n.categories[t],!0).style("fill","none").style("stroke",s).style("stroke-width",1.5).style("stroke-opacity",.01).on("mouseover",uv.effects.line.mouseover(n,t)).on("mouseout",uv.effects.line.mouseout(n,t,s)).transition().duration(n.config.effects.duration).delay(2*t*n.config.effects.duration).style("stroke-opacity",1),e.path.selectAll("circle").data(n.dataset[t]).enter().append("circle").attr("cx",e.func.x()).attr("cy",e.func.y()).attr("r",3.5).classed("cr_"+n.categories[t],!0).style("fill",s).style("fill-opacity",.2).style("stroke",s).on("mouseover",uv.effects.line.mouseover(n,t)).on("mouseout",uv.effects.line.mouseout(n,t,s)).append("svg:title").text(function(e,r){return n.categories[t]+" ["+n.labels[r]+"]: "+e.value}),e.path.selectAll("text").data(n.dataset[t]).enter().append("text").attr("x",function(e){return r.hor.scale(e.name)+r.hor.scale.rangeBand()/2}).attr("y",function(e){return r.ver.scale(e.value)-20}).attr("dx",0).attr("dy",".71em").attr("text-anchor","middle").classed("cr_"+n.categories[t],!0).style("fill","none").style("font-family",n.config.bar.fontfamily).style("font-size",n.config.bar.fontsize).style("font-weight",n.config.bar.fontweight).text(function(e){return String(e.value)}),this},uv.PercentAreaGraph=function(e,t){var n=this;uv.Graph.call(n).setDefaults(e,t).init(e,t),stacklayout=d3.layout.stack().offset("zero")(n.categories.map(function(t){return e.dataset[t].map(function(e){return{x:e.name,y:+e.value}})}));var r,i,s,o=n.labels,u=n.categories;n.axes[n.config.graph.orientation==="Horizontal"?"ver":"hor"].scale.domain(o),n.areagroup=n.panel.selectAll("g.areagroup").data(stacklayout).enter().append("g").attr("class",function(e,t){return"cge_"+n.categories[t]}),n["draw"+n.config.graph.orientation+"Area"](),n.finalize(!0)},uv.PercentAreaGraph.prototype=uv.util.extend(uv.Graph),uv.PercentAreaGraph.prototype.setDefaults=function(e,t){return e.stepup="percent",this},uv.PercentAreaGraph.prototype.drawHorizontalArea=function(){var e=this,t=e.axes,n=e.categories,r=e.config,i=uv.util.getSumUpArray(e.graphdef);t.ver.scale.rangePoints([0,e.height()]);for(var s=0;s<n.length;s+=1)uv.effects.area.mouseover(e,s),uv.effects.area.mouseout(e,s);e.areagroup.append("path").attr("class",function(e,t){return"area_"+n[t]}).style("fill",function(e,t){return uv.util.getColorBand(r,t)}).attr("d",d3.svg.area().y(function(e){return t.ver.scale(e.x)+t.ver.scale.rangeBand()/2}).x0(function(e,n){return t.hor.scale(uv.util.getPercentage(e.y0,i[n]))}).x1(function(e,n){return t.hor.scale(uv.util.getPercentage(e.y0+e.y,i[n]))}).interpolate(e.config.area.interpolation)).on("mouseover",function(t,r){e.effects[n[r]].mouseover()}).on("mouseout",function(t,r){e.effects[n[r]].mouseout()}),e.areagroup.append("path").attr("class",function(e,t){return"line_"+n[t]}).style("stroke","white").style("fill","none").style("stroke-width",2).attr("d",d3.svg.line().y(function(e){return t.ver.scale(e.x)+t.ver.scale.rangeBand()/2}).x(function(e,n){return t.hor.scale(uv.util.getPercentage(e.y0+e.y,i[n]))}).interpolate(e.config.area.interpolation))},uv.PercentAreaGraph.prototype.drawVerticalArea=function(){var e=this,t=e.axes,n=e.categories,r=e.config,i=uv.util.getSumUpArray(e.graphdef);t.hor.scale.rangePoints([0,e.width()]);for(var s=0;s<n.length;s+=1)uv.effects.area.mouseover(e,s),uv.effects.area.mouseout(e,s);e.areagroup.append("path").attr("class",function(e,t){return"area_"+n[t]}).style("fill",function(e,t){return uv.util.getColorBand(r,t)}).attr("d",d3.svg.area().x(function(e){return t.hor.scale(e.x)+t.hor.scale.rangeBand()/2}).y0(function(e,n){return t.ver.scale(uv.util.getPercentage(e.y0,i[n]))}).y1(function(e,n){return t.ver.scale(uv.util.getPercentage(e.y0+e.y,i[n]))}).interpolate(e.config.area.interpolation)).on("mouseover",function(t,r){e.effects[n[r]].mouseover()}).on("mouseout",function(t,r){e.effects[n[r]].mouseout()}),e.areagroup.append("path").attr("class",function(e,t){return"line_"+n[t]}).style("stroke","white").style("fill","none").style("stroke-width",2).attr("d",d3.svg.line().x(function(e,n){return t.hor.scale(e.x)+t.hor.scale.rangeBand()/2}).y(function(e,n){return t.ver.scale(uv.util.getPercentage(e.y0+e.y,i[n]))}).interpolate(e.config.area.interpolation))},uv.PercentBarGraph=function(e,t){var n=this;uv.Graph.call(n).setDefaults(e,t).init(e,t),n.bargroups=[];var r,i,s,o,u,a=n.labels,f=a.map(function(e){return 0}),l=a.map(function(e){return 0});n.axes[n.config.graph.orientation==="Horizontal"?"ver":"hor"].scale.domain(a);for(s=0,o=n.categories.length;s<o;s+=1)u=uv.util.getColorBand(n.config,s),r=n.panel.append("g").attr("class","cg_"+n.categories[s]),i=r.selectAll("g").data(n.graphdef.dataset[n.categories[s]]).enter().append("g").attr("class","cge_"+n.categories[s]),n["draw"+uv.util.getPascalCasedName(n.config.graph.orientation)+"Bars"](i,f,l,s),n.config.graph.orientation==="Vertical"&&r.attr("transform","translate(0,"+2*n.height()+") scale(1,-1)"),n.bargroups.push(r);n.finalize()},uv.PercentBarGraph.prototype=uv.util.extend(uv.Graph),uv.PercentBarGraph.prototype.setDefaults=function(e,t){return e.stepup="percent",t.scale.ordinality=0,this},uv.PercentBarGraph.prototype.drawHorizontalBars=function(e,t,n,r){var i=this,s=this.axes,o=uv.util.getColorBand(this.config,r),u=this.config,a=uv.util.getSumUpArray(this.graphdef);e.append("rect").attr("height",s.ver.scale.rangeBand()).attr("width",0).attr("x",function(e,n){var r=s.hor.scale(uv.util.getPercentage(t[n],a[n]));return t[n]+=e.value,r}).attr("y",function(e){return s.ver.scale(e.name)}).classed("cr_"+i.categories[r],!0).style("stroke","none").style("fill",o).on("mouseover",uv.effects.bar.mouseover(i,r)).on("mouseout",uv.effects.bar.mouseout(i,r)).transition().duration(uv.config.effects.duration).delay(r*uv.config.effects.duration).attr("width",function(e,t){return s.hor.scale(uv.util.getPercentage(e.value,a[t]))}),e.append("text").attr("y",function(e){return s.ver.scale(e.name)+s.ver.scale.rangeBand()/2}).attr("dx",0).attr("dy",".35em").attr("text-anchor","end").classed("cr_"+i.categories[r],!0).style("fill","none").style("font-family",this.config.bar.fontfamily).style("font-size",this.config.bar.fontsize).style("font-weight",this.config.bar.fontweight).text(function(e,n){return s.hor.scale(uv.util.getPercentage(t[n],a[n]))>15?String(Math.round(uv.util.getPercentage(e.value,a[n]))):null}).transition().duration(uv.config.effects.duration).delay(r*uv.config.effects.duration).attr("x",function(e,t){return n[t]+=e.value,s.hor.scale(uv.util.getPercentage(n[t],a[t]))-5})},uv.PercentBarGraph.prototype.drawVerticalBars=function(e,t,n,r){var i=this,s=this.height(),o=this.axes,u=uv.util.getColorBand(this.config,r),a=this.config,f=uv.util.getSumUpArray(this.graphdef);e.append("rect").attr("height",0).attr("width",o.hor.scale.rangeBand()).attr("x",function(e){return o.hor.scale(e.name)}).attr("y",function(e,n){var r=o.ver.scale(uv.util.getPercentage(t[n],f[n]));return t[n]-=e.value,r}).classed("cr_"+i.categories[r],!0).style("stroke","none").style("fill",u).on("mouseover",uv.effects.bar.mouseover(i,r)).on("mouseout",uv.effects.bar.mouseout(i,r)).transition().duration(uv.config.effects.duration).delay(r*uv.config.effects.duration).attr("height",function(e,t){return s-o.ver.scale(uv.util.getPercentage(e.value,f[t]))}),e.append("text").attr("transform","scale(1,-1)").attr("x",function(e){return o.hor.scale(e.name)+o.hor.scale.rangeBand()/2}).attr("y",-s+5).attr("dy",".71em").attr("text-anchor","middle").classed("cr_"+i.categories[r],!0).style("fill","none").style("font-family",this.config.bar.fontfamily).style("font-size",this.config.bar.fontsize).style("font-weight",this.config.bar.fontweight).text(function(e,t){return s-o.ver.scale(uv.util.getPercentage(e.value,f[t]))>15?String(Math.round(uv.util.getPercentage(e.value,f[t]))):null}).transition().duration(uv.config.effects.duration).delay(r*uv.config.effects.duration).attr("y",function(e,t){return n[t]+=e.value,-(2*s-o.ver.scale(uv.util.getPercentage(n[t],f[t])))+5})},uv.PieGraph=function(e,t){var n=this;uv.Graph.call(n).setDefaults(e,t).init(e,t),n.radius=Math.min(n.height(),n.width())*2/5,n.center={x:n.width()/2,y:n.height()/2},n.category=e.categories[0];var r=uv.util.getCategoryData(n.graphdef,[n.category]),i=d3.svg.arc().innerRadius(0).outerRadius(n.radius),s=d3.layout.pie();n.panel.data(r),n.arcs=n.panel.selectAll("g.arc").data(s).enter().append("g").attr("class","r3_arc"+n.category).attr("transform","translate("+n.center.x+","+n.center.y+")"),n.arcs.append("path").attr("d",i).style("fill",function(e,t){return uv.util.getColorBand(n.config,t)}).style("stroke",n.config.pie.strokecolor).style("stroke-width",n.config.pie.strokewidth).on("mouseover",uv.effects.pie.mouseover(n.center,i,n.config)).on("mouseout",uv.effects.pie.mouseout(n.center,n.config)),n.arcs.append("text").attr("transform",function(e){return"translate("+i.centroid(e)+")"}).attr("dy",".35em").attr("text-anchor","middle").style("fill",n.config.pie.fontfill).style("font-family",n.config.pie.fontfamily).style("font-size",n.config.pie.fontsize).style("font-weight",n.config.pie.fontweight).style("font-variant",n.config.pie.fontvariant).text(function(e){return String(e.value)}),n.arcs.append("svg:title").text(function(e,t){return n.labels[t]+" : "+e.value})},uv.PieGraph.prototype=uv.util.extend(uv.Graph),uv.PieGraph.prototype.setDefaults=function(e,t){return e.stepup=!1,this},uv.StackedAreaGraph=function(e,t){var n=this;uv.Graph.call(n,e).setDefaults(e,t).init(e,t);var r=d3.layout.stack().offset(n.config.area.offset)(n.categories.map(function(t){return e.dataset[t].map(function(e){return{x:e.name,y:+e.value}})}));n.axes[n.config.graph.orientation==="Horizontal"?"ver":"hor"].scale.domain(n.labels.map(function(e){return e})),n.areagroup=n.panel.append("g").selectAll("g").data(r).enter().append("g").attr("class",function(e,t){return"cge_"+n.categories[t]}),n["draw"+n.config.graph.orientation+"Area"](),n.finalize()},uv.StackedAreaGraph.prototype=uv.util.extend(uv.Graph),uv.StackedAreaGraph.prototype.setDefaults=function(e,t){return e.stepup=!0,this},uv.StackedAreaGraph.prototype.drawHorizontalArea=function(){var e=this,t=e.axes,n=e.categories,r=e.config;t.ver.scale.rangePoints([0,e.height()]);for(var i=0;i<n.length;i+=1)uv.effects.area.mouseover(e,i),uv.effects.area.mouseout(e,i);return e.areagroup.append("path").attr("class",function(e,t){return"area_"+n[t]}).style("fill",function(e,t){return uv.util.getColorBand(r,t)}).attr("d",d3.svg.area().y(function(e){return t.ver.scale(e.x)+t.ver.scale.rangeBand()/2}).x0(function(e){return t.hor.scale(e.y0)}).x1(function(e){return t.hor.scale(e.y0+e.y)}).interpolate(e.config.area.interpolation)).on("mouseover",function(t,r){e.effects[n[r]].mouseover()}).on("mouseout",function(t,r){e.effects[n[r]].mouseout()}),e.areagroup.append("path").attr("class",function(e,t){return"line_"+n[t]}).style("stroke","white").style("fill","none").style("stroke-width",2).attr("d",d3.svg.line().y(function(e){return t.ver.scale(e.x)+t.ver.scale.rangeBand()/2}).x(function(e){return t.hor.scale(e.y0+e.y)}).interpolate(e.config.area.interpolation)),e},uv.StackedAreaGraph.prototype.drawVerticalArea=function(){var e=this,t=e.axes,n=e.categories,r=e.config;t.hor.scale.rangePoints([0,e.width()]),e.areagroup.append("path").attr("class","r3_area");for(var i=0;i<n.length;i+=1)uv.effects.area.mouseover(e,i),uv.effects.area.mouseout(e,i);return e.areagroup.append("path").attr("class",function(e,t){return"area_"+n[t]}).style("fill",function(e,t){return uv.util.getColorBand(r,t)}).attr("d",d3.svg.area().x(function(e){return t.hor.scale(e.x)+t.hor.scale.rangeBand()/2}).y0(function(e){return t.ver.scale(e.y0)}).y1(function(e){return t.ver.scale(e.y0+e.y)}).interpolate(e.config.area.interpolation)).on("mouseover",function(t,r){e.effects[n[r]].mouseover()}).on("mouseout",function(t,r){e.effects[n[r]].mouseout()}),e.areagroup.append("path").attr("class",function(e,t){return"line_"+n[t]}).style("stroke","white").style("fill","none").style("stroke-width",2).attr("d",d3.svg.line().x(function(e){return t.hor.scale(e.x)+t.hor.scale.rangeBand()/2}).y(function(e){return t.ver.scale(e.y0+e.y)}).interpolate(e.config.area.interpolation)),e},uv.StackedBarGraph=function(e,t){var n=this;uv.Graph.call(n).setDefaults(e,t).init(e,t),n.bargroups={};var r,i,s,o,u,a=n.labels,f=a.map(function(e){return 0}),l=a.map(function(e){return 0});n.axes[n.config.graph.orientation==="Horizontal"?"ver":"hor"].scale.domain(a);for(s=0,o=n.categories.length;s<o;s+=1)n.bargroups[n.categories[s]]=n.panel.append("g").attr("class","cge_"+n.categories[s]),n["draw"+n.config.graph.orientation+"Bars"](s,f,l);n.finalize()},uv.StackedBarGraph.prototype=uv.util.extend(uv.Graph),uv.StackedBarGraph.prototype.setDefaults=function(e,t){return e.stepup=!0,this},uv.StackedBarGraph.prototype.drawHorizontalBars=function(e,t,n){var r=this,i=this.axes,s=uv.util.getColorBand(this.config,e),o=this.config,u=this.bargroups[this.categories[e]];bars=u.selectAll("g").data(this.graphdef.dataset[this.categories[e]]).enter().append("g").attr("class","cge_"+this.categories[e]),bars.append("rect").attr("height",i.ver.scale.rangeBand()).attr("width",0).attr("x",function(e,n){var r=i.hor.scale(t[n]);return t[n]+=e.value,r}).attr("y",function(e){return i.ver.scale(e.name)}).classed("cr_"+r.categories[e],!0).style("stroke","none").style("fill",s).on("mouseover",uv.effects.bar.mouseover(r,e)).on("mouseout",uv.effects.bar.mouseout(r,e)).transition().duration(uv.config.effects.duration).delay(e*uv.config.effects.duration).attr("width",function(e){return i.hor.scale(e.value)}),bars.append("text").attr("y",function(e){return i.ver.scale(e.name)+i.ver.scale.rangeBand()/2}).attr("dx",0).attr("dy",".35em").attr("text-anchor","end").classed("cr_"+r.categories[e],!0).style("fill","none").style("font-family",o.bar.fontfamily).style("font-size",o.bar.fontsize).style("font-weight",o.bar.fontweight).text(function(e){return i.hor.scale(e.value)>15?String(e.value):null}).transition().duration(uv.config.effects.duration).delay(e*uv.config.effects.duration).attr("x",function(e,t){return n[t]+=e.value,i.hor.scale(n[t])-5}),bars.append("svg:title").text(function(t,n){return r.categories[e]+" ["+r.labels[n]+"] : "+t.value})},uv.StackedBarGraph.prototype.drawVerticalBars=function(e,t,n){var r=this,i=this.height(),s=this.axes,o=uv.util.getColorBand(this.config,e),u=this.config,a=this.bargroups[this.categories[e]];bars=a.selectAll("g").data(this.graphdef.dataset[this.categories[e]]).enter().append("g").attr("class","r3_stackedbar_"+this.categories[e]),bars.append("rect").attr("height",0).attr("width",s.hor.scale.rangeBand()).attr("x",function(e){return s.hor.scale(e.name)}).attr("y",function(e,n){var r=s.ver.scale(t[n]);return t[n]-=e.value,r}).classed("cr_"+r.categories[e],!0).style("stroke","none").style("fill",o).on("mouseover",uv.effects.bar.mouseover(r,e)).on("mouseout",uv.effects.bar.mouseout(r,e)).transition().duration(uv.config.effects.duration).delay(e*uv.config.effects.duration).attr("height",function(e){return i-s.ver.scale(e.value)}),bars.append("text").attr("transform","scale(1,-1)").attr("x",function(e){return s.hor.scale(e.name)+s.hor.scale.rangeBand()/2}).attr("y",-i+5).attr("dy",".71em").attr("text-anchor","middle").classed("cr_"+r.categories[e],!0).style("fill","none").style("font-family",u.bar.fontfamily).style("font-size",u.bar.fontsize).style("font-weight",u.bar.fontweight).text(function(e){return i-s.ver.scale(e.value)>15?String(e.value):null}).transition().duration(uv.config.effects.duration).delay(e*uv.config.effects.duration).attr("y",function(e,t){return n[t]+=e.value,-(2*i-s.ver.scale(n[t]))+5}),bars.append("svg:title").text(function(t,n){return r.categories[e]+" ["+r.labels[n]+"] : "+t.value}),a.attr("transform","translate(0,"+2*this.height()+") scale(1,-1)")},uv.StepUpBarGraph=function(e,t){var n=this;uv.Graph.call(n).setDefaults(e,t).init(e,t),this.bargroups={};var r,i=n.categories.length,s=n.labels.map(function(e){return 0}),o=n.labels.map(function(e){return 0});n.axes[this.config.graph.orientation==="Horizontal"?"ver":"hor"].scale.domain(this.labels);for(r=0;r<i;r+=1)n.bargroups[n.categories[r]]=this.panel.append("g").attr("class","cg_"+n.categories[r]),n["draw"+n.config.graph.orientation+"Bars"](r,s,o);n.finalize()},uv.StepUpBarGraph.prototype=uv.util.extend(uv.Graph),uv.StepUpBarGraph.prototype.setDefaults=function(e,t){return e.stepup=!0,this},uv.StepUpBarGraph.prototype.drawHorizontalBars=function(e,t,n){var r=this,i=r.categories.length;color=uv.util.getColorBand(r.config,e),bargroup=r.bargroups[r.categories[e]],bars=bargroup.selectAll("g").data(r.graphdef.dataset[r.categories[e]]).enter().append("g").attr("class","cge_"+r.categories[e]),bars.append("rect").attr("height",r.axes.ver.scale.rangeBand()/i).attr("width",0).attr("x",function(e,n){var i=r.axes.hor.scale(t[n]);return t[n]+=e.value,i}).attr("y",function(e){return r.axes.ver.scale(e.name)}).classed("cr_"+r.categories[e],!0).style("stroke","none").style("fill",color).on("mouseover",uv.effects.bar.mouseover(r,e)).on("mouseout",uv.effects.bar.mouseout(r,e,color)).transition().duration(r.config.effects.duration).delay(e*r.config.effects.duration).attr("width",function(e){return r.axes.hor.scale(e.value)}),bars.append("text").attr("y",function(e){return r.axes.ver.scale(e.name)+r.axes.ver.scale.rangeBand()/i/2}).attr("dx",4).attr("dy",".35em").attr("text-anchor","start").classed("cr_"+r.categories[e],!0).style("fill","none").style("font-family",r.config.bar.fontfamily).style("font-size",r.config.bar.fontsize).style("font-weight",r.config.bar.fontweight).text(function(e){return String(e.value)}).transition().duration(r.config.effects.duration).delay(e*r.config.effects.duration).attr("x",function(e,t){return n[t]+=e.value,r.axes.hor.scale(n[t])}),bars.append("svg:title").text(function(t,n){return r.categories[e]+" ["+r.labels[n]+"] : "+t.value}),bargroup.attr("transform","translate(0,"+e*r.axes.ver.scale.rangeBand()/i+")")},uv.StepUpBarGraph.prototype.drawVerticalBars=function(e,t,n){var r=this,i=r.categories.length,s=uv.util.getColorBand(r.config,e),o=r.bargroups[r.categories[e]];bars=o.selectAll("g").data(r.graphdef.dataset[r.categories[e]]).enter().append("g").attr("class","cge_"+r.categories[e]),bars.append("rect").attr("height",0).attr("width",r.axes.hor.scale.rangeBand()/i).attr("x",function(e){return r.axes.hor.scale(e.name)}).attr("y",function(e,n){var i=r.axes.ver.scale(t[n]);return t[n]-=e.value,i}).classed("cr_"+r.categories[e],!0).style("stroke","none").style("fill",s).on("mouseover",uv.effects.bar.mouseover(r,e)).on("mouseout",uv.effects.bar.mouseout(r,e,s)).transition().duration(r.config.effects.duration).delay(e*r.config.effects.duration).attr("height",function(e){return r.height()-r.axes.ver.scale(e.value)}),bars.append("text").attr("transform","scale(1,-1)").attr("x",function(e){return r.axes.hor.scale(e.name)+r.axes.hor.scale.rangeBand()/i/2}).attr("y",-r.height()-10).attr("dy",".71em").attr("text-anchor","middle").classed("cr_"+r.categories[e],!0).style("fill","none").style("font-family",r.config.bar.fontfamily).style("font-size",r.config.bar.fontsize).style("font-weight",r.config.bar.fontweight).text(function(e){return String(e.value)}).transition().duration(r.config.effects.duration).delay(e*r.config.effects.duration).attr("y",function(e,t){return n[t]+=e.value,-(2*r.height()-r.axes.ver.scale(n[t]))-10}),bars.append("svg:title").text(function(t,n){return r.categories[e]+" ["+r.labels[n]+"] : "+t.value}),o.attr("transform","translate("+e*r.axes.hor.scale.rangeBand()/i+","+2*r.height()+") scale(1,-1)")},uv.Table=function(){this.caption=undefined,this.position=undefined,this.graphdef=undefined,this.table=undefined,this.header=undefined,this.body=undefined,this.bodyrows={}},uv.Table.prototype.init=function(e,t){this.graphdef=e,this.config=$.extend(!0,{},t),this.position=this.config.meta.pos||"body",this.table=d3.select(this.position).append("table").attr("class",this.config.table.tableclass),this.header=this.table.append("thead").attr("class",this.config.table.headerclass),this.body=this.table.append("tbody").attr("class",this.config.table.bodyclass),this.footer=this.table.append("tfoot").attr("class",this.config.table.footerclass)},uv.Table.prototype.finalize=function(){},uv.TableGraph=function(e,t){uv.Table.apply(this,[e]),this.init(e,t),this.config.graph.orientation==="Horizontal"?this.setHorTable():this.setVerTable(),this.finalize()},uv.TableGraph.prototype=uv.util.extend(uv.Table),uv.TableGraph.prototype.setHorTable=function(){var e=this.graphdef.categories,t=uv.util.getTabularArray(this.graphdef);e.unshift(""),this.header.append("tr").selectAll("td").data(e).enter().append("td").text(function(e){return e}),e.shift(),this.bodyrows=this.body.selectAll("tr").data(t).enter().append("tr"),this.bodyrows.selectAll("td").data(function(e,n){return t[n]}).enter().append("td").attr("class",function(e,t){return t===0?"chart3rtablelabel":"chart3rtabledata"}).text(function(e){return e})},uv.TableGraph.prototype.setVerTable=function(){var e=uv.util.getLabelArray(this.graphdef),t=this.graphdef.dataset;e.unshift(""),this.header.append("tr").selectAll("td").data(e).enter().append("td").text(function(e){return e}),e.shift(),this.bodyrows=this.body.selectAll("tr").data(this.graphdef.categories).enter().append("tr"),this.bodyrows.selectAll("td").data(function(e){var n=[],r,i;n.push(e);for(r=0,i=t[e].length;r<i;r+=1)n.push(t[e][r].value);return n}).enter().append("td").attr("class",function(e,t){return t===0?"chart3rtablelabel":"chart3rtabledata"}).text(function(e){return e})};